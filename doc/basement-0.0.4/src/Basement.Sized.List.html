<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- Module      : Basement.Sized.List</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- License     : BSD-style</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Maintainer  : Vincent Hanquez &lt;vincent@snarc.org&gt;</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Portability : portable</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- A Nat-sized list abstraction</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Using this module is limited to GHC 7.10 and above.</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE KindSignatures            #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE DataKinds                 #-}</span><span>
</span><a name="line-14"></a><span class="hs-pragma">{-# LANGUAGE GADTs                     #-}</span><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators             #-}</span><span>
</span><a name="line-16"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies              #-}</span><span>
</span><a name="line-17"></a><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><a name="line-18"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables       #-}</span><span>
</span><a name="line-19"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances      #-}</span><span>
</span><a name="line-20"></a><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes       #-}</span><span>
</span><a name="line-21"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">Sized</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#toListN"><span class="hs-identifier hs-var">toListN</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#unListN"><span class="hs-identifier hs-var">unListN</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#length"><span class="hs-identifier hs-var">length</span></a><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#create"><span class="hs-identifier hs-var">create</span></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#createFrom"><span class="hs-identifier hs-var">createFrom</span></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#uncons"><span class="hs-identifier hs-var">uncons</span></a><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#cons"><span class="hs-identifier hs-var">cons</span></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#index"><span class="hs-identifier hs-var">index</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#indexStatic"><span class="hs-identifier hs-var">indexStatic</span></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#map"><span class="hs-identifier hs-var">map</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#elem"><span class="hs-identifier hs-var">elem</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#append"><span class="hs-identifier hs-var">append</span></a><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#minimum"><span class="hs-identifier hs-var">minimum</span></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#maximum"><span class="hs-identifier hs-var">maximum</span></a><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#head"><span class="hs-identifier hs-var">head</span></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#tail"><span class="hs-identifier hs-var">tail</span></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#take"><span class="hs-identifier hs-var">take</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#drop"><span class="hs-identifier hs-var">drop</span></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zip4"><span class="hs-identifier hs-var">zip4</span></a><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zip5"><span class="hs-identifier hs-var">zip5</span></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zipWith3"><span class="hs-identifier hs-var">zipWith3</span></a><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zipWith4"><span class="hs-identifier hs-var">zipWith4</span></a><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#zipWith5"><span class="hs-identifier hs-var">zipWith5</span></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-comment">-- * Applicative And Monadic</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#replicateM"><span class="hs-identifier hs-var">replicateM</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#mapM"><span class="hs-identifier hs-var">mapM</span></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Basement.Sized.List.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Proxy</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span>           </span><a href="Basement.Compat.Base.html"><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">Compat</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>           </span><a href="Basement.Nat.html"><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">Nat</span></a><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span>           </span><a href="Basement.NormalForm.html"><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">NormalForm</span></a><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span>           </span><a href="Basement.Numerical.Additive.html"><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">Numerical</span><span class="hs-operator">.</span><span class="hs-identifier">Additive</span></a><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span>           </span><a href="Basement.Numerical.Subtractive.html"><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">Numerical</span><span class="hs-operator">.</span><span class="hs-identifier">Subtractive</span></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span>           </span><a href="Basement.Types.OffsetSize.html"><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span class="hs-operator">.</span><span class="hs-identifier">OffsetSize</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span>           </span><a href="Basement.Compat.ExtList.html"><span class="hs-identifier">Basement</span><span class="hs-operator">.</span><span class="hs-identifier">Compat</span><span class="hs-operator">.</span><span class="hs-identifier">ExtList</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Basement.Compat.ExtList.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicateM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mapM</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-identifier">impossible</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679083856"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-69"></a><a name="impossible"><a href="Basement.Sized.List.html#impossible"><span class="hs-identifier">impossible</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;ListN: internal error: the impossible happened&quot;</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-keyword">newtype</span><span> </span><a name="ListN"><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier">ListN</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679083745"><a href="#local-6989586621679083745"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679083746"><a href="#local-6989586621679083746"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ListN"><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier">ListN</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unListN"><a href="Basement.Sized.List.html#unListN"><span class="hs-identifier">unListN</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679083746"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679084458"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679084459"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679084458"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>    </span><a name="local-8214565720323790571"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><a name="local-6989586621679084460"><a href="#local-6989586621679084460"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679084460"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-keyword">instance</span><span> </span><a href="Basement.NormalForm.html#NormalForm"><span class="hs-identifier hs-type">NormalForm</span></a><span> </span><a href="#local-6989586621679084455"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Basement.NormalForm.html#NormalForm"><span class="hs-identifier hs-type">NormalForm</span></a><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679084456"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679084455"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-78"></a><span>    </span><a name="local-8214565720323851687"><a href="Basement.NormalForm.html#toNormalForm"><span class="hs-identifier">toNormalForm</span></a></a><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><a name="local-6989586621679084457"><a href="#local-6989586621679084457"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Basement.NormalForm.html#toNormalForm"><span class="hs-identifier hs-var">toNormalForm</span></a><span> </span><a href="#local-6989586621679084457"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-identifier">toListN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679083854"><a href="#local-6989586621679083854"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679083855"><a href="#local-6989586621679083855"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679083854"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><a href="Basement.Nat.html#NatWithinBound"><span class="hs-identifier hs-type">NatWithinBound</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="#local-6989586621679083854"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679083855"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679083854"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679083855"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a><a name="toListN"><a href="Basement.Sized.List.html#toListN"><span class="hs-identifier">toListN</span></a></a><span> </span><a name="local-6989586621679083857"><a href="#local-6989586621679083857"><span class="hs-identifier">l</span></a></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679083858"><span class="hs-identifier hs-var">expected</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Prelude</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prelude</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679083857"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><a href="#local-6989586621679083857"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                                           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>    </span><a name="local-6989586621679083858"><a href="#local-6989586621679083858"><span class="hs-identifier">expected</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Basement.Nat.html#natValInt"><span class="hs-identifier hs-var">natValInt</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679083854"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-identifier">replicateM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679083851"><a href="#local-6989586621679083851"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679083852"><a href="#local-6989586621679083852"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679083853"><a href="#local-6989586621679083853"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Basement.Nat.html#NatWithinBound"><span class="hs-identifier hs-type">NatWithinBound</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="#local-6989586621679083851"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679083852"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679083851"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679083852"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679083853"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679083852"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679083851"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679083853"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><a name="replicateM"><a href="Basement.Sized.List.html#replicateM"><span class="hs-identifier">replicateM</span></a></a><span> </span><a name="local-6989586621679083859"><a href="#local-6989586621679083859"><span class="hs-identifier">action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">replicateM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prelude</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679083851"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679083859"><span class="hs-identifier hs-var">action</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-identifier">mapM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679083847"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083848"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679083847"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679083849"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679083850"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679083848"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679083847"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679083850"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679083849"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><a name="mapM"><a href="Basement.Sized.List.html#mapM"><span class="hs-identifier">mapM</span></a></a><span> </span><a name="local-6989586621679083860"><a href="#local-6989586621679083860"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><a name="local-6989586621679083861"><a href="#local-6989586621679083861"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679083860"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679083861"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-identifier">mapM_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679083843"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679083844"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679083843"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679083845"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679083846"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679083844"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679083843"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><a name="mapM_"><a href="Basement.Sized.List.html#mapM_"><span class="hs-identifier">mapM_</span></a></a><span> </span><a name="local-6989586621679084338"><a href="#local-6989586621679084338"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><a name="local-6989586621679084339"><a href="#local-6989586621679084339"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapM_</span><span> </span><a href="#local-6989586621679084338"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679084339"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-identifier">replicate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679083841"><a href="#local-6989586621679083841"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Nat</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679083842"><a href="#local-6989586621679083842"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Basement.Nat.html#NatWithinBound"><span class="hs-identifier hs-type">NatWithinBound</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><a href="#local-6989586621679083841"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">KnownNat</span><span> </span><a href="#local-6989586621679083841"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679083842"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-type">ListN</span></a><span> </span><a href="#local-6989586621679083841"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679083842"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-97"></a><a name="replicate"><a href="Basement.Sized.List.html#replicate"><span class="hs-identifier">replicate</span></a></a><span> </span><a name="local-6989586621679084340"><a href="#local-6989586621679084340"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Basement.Sized.List.html#ListN"><span class="hs-identifier hs-var">ListN</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Prelude</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">replicate</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prelude</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">natVal</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679083841"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679084340"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-identifier">uncons</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CmpNat</span><span> </span><a href="#local-6989586621679083839"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-char">'GT =&gt; ListN n a -&gt; (a, ListN (n-1) a)
uncons (ListN (x:xs)) = (x, ListN xs)
uncons _ = impossible

cons :: a -&gt; ListN n a -&gt; ListN (n+1) a
cons a (ListN l) = ListN (a : l)

empty :: ListN 0 a
empty = ListN []

length :: forall a (n :: Nat) . (KnownNat n, NatWithinBound Int n) =&gt; ListN n a -&gt; Int
length _ = natValInt (Proxy :: Proxy n)

create :: forall a (n :: Nat) . KnownNat n =&gt; (Integer -&gt; a) -&gt; ListN n a
create f = ListN $ Prelude.map f [0..(len-1)]
  where
    len = natVal (Proxy :: Proxy n)

createFrom :: forall a (n :: Nat) (start :: Nat) . (KnownNat n, KnownNat start)
           =&gt; Proxy start -&gt; (Integer -&gt; a) -&gt; ListN n a
createFrom p f = ListN $ Prelude.map f [idx..(idx+len-1)]
  where
    len = natVal (Proxy :: Proxy n)
    idx = natVal p

singleton :: a -&gt; ListN 1 a
singleton a = ListN [a]

elem :: Eq a =&gt; a -&gt; ListN n a -&gt; Bool
elem a (ListN l) = Prelude.elem a l

append :: ListN n a -&gt; ListN m a -&gt; ListN (n+m) a
append (ListN l1) (ListN l2) = ListN (l1 &lt;&gt; l2)

maximum :: (Ord a, CmpNat n 0 ~ 'GT) =&gt; ListN n a -&gt; a
maximum (ListN l) = Prelude.maximum l

minimum :: (Ord a, CmpNat n 0 ~ 'GT) =&gt; ListN n a -&gt; a
minimum (ListN l) = Prelude.minimum l

head :: CmpNat n 0 ~ 'GT =&gt; ListN n a -&gt; a
head (ListN (x:_)) = x
head _ = impossible

tail :: CmpNat n 0 ~ 'GT =&gt; ListN n a -&gt; ListN (n-1) a
tail (ListN (_:xs)) = ListN xs
tail _ = impossible

take :: forall a (m :: Nat) (n :: Nat) . (KnownNat m, NatWithinBound Int m, m &lt;= n) =&gt; ListN n a -&gt; ListN m a
take (ListN l) = ListN (Prelude.take n l)
  where n = natValInt (Proxy :: Proxy m)

drop :: forall a d (m :: Nat) (n :: Nat) . (KnownNat d, NatWithinBound Int d, (n - m) ~ d, m &lt;= n) =&gt; ListN n a -&gt; ListN m a
drop (ListN l) = ListN (Prelude.drop n l)
  where n = natValInt (Proxy :: Proxy d)

splitAt :: forall a d (m :: Nat) (n :: Nat) . (KnownNat d, NatWithinBound Int d, (n - m) ~ d, m &lt;= n) =&gt; ListN n a -&gt; (ListN m a, ListN (n-m) a)
splitAt (ListN l) = let (l1, l2) = Prelude.splitAt n l in (ListN l1, ListN l2)
  where n = natValInt (Proxy :: Proxy d)

indexStatic :: forall i n a . (KnownNat i, CmpNat i n ~ 'LT, Offsetable a i) =&gt; ListN n a -&gt; a
indexStatic (ListN l) = l !! (natValOffset (Proxy :: Proxy i))

index :: ListN n ty -&gt; Offset ty -&gt; ty
index (ListN l) ofs = l !! ofs

map :: (a -&gt; b) -&gt; ListN n a -&gt; ListN n b
map f (ListN l) = ListN (Prelude.map f l)

foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; ListN n a -&gt; b
foldl f acc (ListN l) = Prelude.foldl f acc l

foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; ListN n a -&gt; b
foldl' f acc (ListN l) = Data.List.foldl' f acc l

foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; ListN n a -&gt; b
foldr f acc (ListN l) = Prelude.foldr f acc l

zip :: ListN n a -&gt; ListN n b -&gt; ListN n (a,b)
zip (ListN l1) (ListN l2) = ListN (Prelude.zip l1 l2)

zip3 :: ListN n a -&gt; ListN n b -&gt; ListN n c -&gt; ListN n (a,b,c)
zip3 (ListN x1) (ListN x2) (ListN x3) = ListN (loop x1 x2 x3)
  where loop (l1:l1s) (l2:l2s) (l3:l3s) = (l1,l2,l3) : loop l1s l2s l3s
        loop []       _        _        = []
        loop _        _        _        = impossible

zip4 :: ListN n a -&gt; ListN n b -&gt; ListN n c -&gt; ListN n d -&gt; ListN n (a,b,c,d)
zip4 (ListN x1) (ListN x2) (ListN x3) (ListN x4) = ListN (loop x1 x2 x3 x4)
  where loop (l1:l1s) (l2:l2s) (l3:l3s) (l4:l4s) = (l1,l2,l3,l4) : loop l1s l2s l3s l4s
        loop []       _        _        _        = []
        loop _        _        _        _        = impossible

zip5 :: ListN n a -&gt; ListN n b -&gt; ListN n c -&gt; ListN n d -&gt; ListN n e -&gt; ListN n (a,b,c,d,e)
zip5 (ListN x1) (ListN x2) (ListN x3) (ListN x4) (ListN x5) = ListN (loop x1 x2 x3 x4 x5)
  where loop (l1:l1s) (l2:l2s) (l3:l3s) (l4:l4s) (l5:l5s) = (l1,l2,l3,l4,l5) : loop l1s l2s l3s l4s l5s
        loop []       _        _        _        _        = []
        loop _        _        _        _        _        = impossible

zipWith :: (a -&gt; b -&gt; x) -&gt; ListN n a -&gt; ListN n b -&gt; ListN n x
zipWith f (ListN (v1:vs)) (ListN (w1:ws)) = ListN (f v1 w1 : unListN (zipWith f (ListN vs) (ListN ws)))
zipWith _ (ListN [])       _ = ListN []
zipWith _ _                _ = impossible

zipWith3 :: (a -&gt; b -&gt; c -&gt; x)
         -&gt; ListN n a
         -&gt; ListN n b
         -&gt; ListN n c
         -&gt; ListN n x
zipWith3 f (ListN (v1:vs)) (ListN (w1:ws)) (ListN (x1:xs)) =
    ListN (f v1 w1 x1 : unListN (zipWith3 f (ListN vs) (ListN ws) (ListN xs)))
zipWith3 _ (ListN []) _       _ = ListN []
zipWith3 _ _          _       _ = impossible

zipWith4 :: (a -&gt; b -&gt; c -&gt; d -&gt; x)
         -&gt; ListN n a
         -&gt; ListN n b
         -&gt; ListN n c
         -&gt; ListN n d
         -&gt; ListN n x
zipWith4 f (ListN (v1:vs)) (ListN (w1:ws)) (ListN (x1:xs)) (ListN (y1:ys)) =
    ListN (f v1 w1 x1 y1 : unListN (zipWith4 f (ListN vs) (ListN ws) (ListN xs) (ListN ys)))
zipWith4 _ (ListN []) _       _       _ = ListN []
zipWith4 _ _          _       _       _ = impossible

zipWith5 :: (a -&gt; b -&gt; c -&gt; d -&gt; e -&gt; x)
         -&gt; ListN n a
         -&gt; ListN n b
         -&gt; ListN n c
         -&gt; ListN n d
         -&gt; ListN n e
         -&gt; ListN n x
zipWith5 f (ListN (v1:vs)) (ListN (w1:ws)) (ListN (x1:xs)) (ListN (y1:ys)) (ListN (z1:zs)) =
    ListN (f v1 w1 x1 y1 z1 : unListN (zipWith5 f (ListN vs) (ListN ws) (ListN xs) (ListN ys) (ListN zs)))
zipWith5 _ (ListN []) _       _       _       _ = ListN []
zipWith5 _ _          _       _       _       _ = impossible
</span></pre></body></html>